#!/usr/bin/env python

import os
import os.path
from subprocess import check_output

def find_in(search_dir, books):
    for base_dir, dirs, files in os.walk(search_dir):
        for file in files:
            books[os.path.splitext(file)[0]] = os.path.join(base_dir, file)

book_dir = os.path.expandvars("$HOME/Dropbox/computer_science")
docs_dir = os.path.expandvars("$HOME/Documents")

books = {}
find_in(book_dir, books)
find_in(docs_dir, books)

try:
    book = check_output("echo '%s' | dmenu-vert" % "\n".join(books.keys()),
                        shell=True)
except:
    book = ""

if book != "":
    book = book.strip()
    check_output("evince '%s'" % books[book], shell=True)
